dist: bionic
os:
- linux

jobs:
  include:
    - stage: build docker image
      script:
      - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
      - docker build -t ignition-citadel-builder .
      - docker images
      - docker tag ignition-citadel-builder $DOCKER_USERNAME/ignition-citadel-builder
      - docker push $DOCKER_USERNAME/ignition-citadel-builder
    - stage: test
      script: docker run --rm $DOCKER_USERNAME/ignition-citadel-builder echo hola

# script:
# - mkdir -p ignition_workspace/src
# - cd ignition_workspace/src
# - wget https://raw.githubusercontent.com/ignition-tooling/gazebodistro/master/collection-citadel.yaml
# - vcs import < collection-citadel.yaml
# - cd ..
# - colcon build --merge-install

# after_script:
# - export IGN_IP=127.0.01
# - colcon test --merge-install
# - colcon test-result --verbose


